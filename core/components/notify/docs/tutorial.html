<h3>Overview</h3>
<p>Notify will let you send an email notification to Subscribers on your site (or to all active users) when a page is created or updated (or just when you feel like sending them a message). Rather than sending the whole page, Notify sends a message with a link to the new or updated page. Optionally, you can specify tags for the message and only subscribers with those tags set will receive the email. Notify works in conjunction with the Subscribe extra, which lets users register at your site and manage their preferences (tags).</p>

<p>(Jump to <a href>="[[~[[*id]]]#propertiesTable">Properties Table</a>.)</p>

<p>Notify will also send Tweets to Twitter and (optionally) post the Tweets to your Facebook page. There is an option to shorten any URLs present in any of the Notify Tpl chunks using any of a variety of URL shortening services (TinyUrl, Google, StumbleUpon, bit.ly, is.gd,  and to.ly at present).</p>

<h3>Installing Notify for MODX Revolution</h3>
<p>
Go to System | Package Management on the main menu in the MODX Manager and click on the "Download Extras" button. That will take you to the Revolution Repository (AKA Web Transport Facility). Put Notify in the search box and press Enter. Click on the "Download" button, and when it changes to "Downloaded," click on the button that takes you back to Package Management. Click on the "Install" button next to Notify in the grid. The Notify package should now be installed.</p>
        
<p>During the installation, the Notify TV will be connected to the site's default template. If you need to attach it to other templates, you'll have to connect it manually by editing the TV, checking the boxes on the &quot;Template Access&quot; tab, and clicking on the &quot;Save&quot; button.</p>
        
<p>If you want Notify to post to Twitter and/or Facebook, you'll need to set the four Twitter properties (see below).</p>
        

<h3>Using Notify</h3>

<p>Notify uses a front-end form to send notifications to subscribers, and Messages to Twitter and/or Facebook. When you click on the &quot;Launch Notify&quot; button of the Notify TV when editing a resource, (having set the desired radio-button option) you are forwarded to the Notify resource, where the Notify snippet pre-fills and displays the Notify form. Note that sending updates with Notify is always strictly manual. No updates to subscribers, twitter, or facebook are ever sent automatically. For some people, receiving an update every time you save a page can get pretty annoying, so Notify only sends updates when you tell it to by submitting the form with one of the update options checked.</p>

<p>To launch the Notify form:</p>
<ol>
    <li>Go to the Create/Edit Resource form for a document</li>
    <li>Click on the &quot;Template Variables&quot; tab</li>
    <li>Select the Notify area, if necessary</li>
    <li>Select the type of update you want from the radio options</li>
    <li>Click on the &quot;Launch Notify&quot; button</li>
</ol>

<p>That will launch the notify Form </p>

<p>The Notify snippet pre-fills the Notify form. The values for the email, email subject, and Tweet come from the Notify Tpl chunks. The four radio buttons below the &quot;Launch Notify&quot; button set which chunks are used for the Email text and Tweet text. For both email and Twitter, there is a Tpl chunk for notifying users of new resources and one for announcing updates to existing resources. The two custom Tpls (one for the email and one for Twitter) can be used for anything you want. Finally, there is a blank option which will display the form with the Email text and Tweet text fields empty. If you want to change any of the default Tpl chunks, be sure to duplicate them (adding the prefix &quot;My&quot;). Then create a property set for Notify (see below) and set their names in the property set.

<p>You can change the text in any of the fields before submitting the form. If you change the text of the email, click on the &quot;Submit&quot; button without checking any of the checkboxes to see a preview of the email in the Preview window.</p>
        
<p>When sending updates, Notify acts when you submit the form, but only when you have set at least one of the checkboxes. To send an update, just check the appropriate checkboxes, then submit the form. You can alter any field on the form, but if you do, don't use any placeholders. Placeholders are only replaced when the form is first rendered. Also, any URLs you enter will not be shortened. Again, that only happens when the form is first rendered.</p>
        
<p>The various options are independent, so you can send a test email, send a message to subscribers, or send a Tweet without activating the other options.</p>
        
<p>Notify pre-fills the email subject, email message, and Tweet fields for you, but you can put whatever you want into them. If you just want to email your subscribers to tell them what you had for breakfast, you can do that. The only page-specific information will be the URL (filled in by Notify) and any Resource Content tags that you include in the Tpl chunk (e.g. <fixedpre>pagetitle</fixedpre>, <fixedpre>introtext</fixedpre>, <fixedpre>description</fixedpre> , etc.). You're free to add, or delete any of them. In other words, you can use Notify to send any email message to your subscribers, optionally selected by Group(s) and/or Tag(s). Just remember that placeholders are not available to you if you do this.</p>

[[$CreateSnippetPropertySet? &snippetName=`Notify`]]

<h3>Groups</h3>
        
<p>Email is only sent to active users. The <fixedpre>groups</fixedpre> property can contain a comma-separated list (no spaces) of User Groups to send to. You can specify them by name or by User Group ID number. By default, Notify sends to members of the &quot;Subscribers&quot; User group, but you can change that by setting the <fixedpre>groups</fixedpre> property. Whatever is set will appear in the Notify form, but you can change it there. If you leave the Groups field in the Notify form blank when submitting the form, the email message will be sent to all active users on your site. </p>
        
<h3>Tags</h3>

<p>The <fixedpre>tags</fixedpre> property is blank by default, so the email is sent to all members of User Groups specified in the <fixedpre>groups</fixedpre> property. If you enter tags in the Tags field, only users who have those tags (interests) will receive the email.</p>

<p>You can fill in the user interests for each user as a comma-separated list (no spaces) in the &quot;Comment&quot; field of the User Profile (or optionally in an extended field of the User Profile), but the Subscribe package will do that for you and it will also let users manage their own interest lists. See the Subscribe package documentation for more information on how the Tags are stored.</p>
        
<p>If you're not using the Subscribe package and you'd rather use an extended field of the User Profile instead of the comment field, you can create two new System Settings (put them in the Notify namespace to make them easier to find):</p>

<pre><fixedpre>
sbs_use_comment_field   (set the value to 'No')
sbs_extended_field   (name of the extended field you want to use)
</fixedpre></pre>
        
<p>You'll have to create the extended field for each user unless the Subscribe extra has done it for you. You'll also have to create a chunk to hold the list of user preferences (tags) and set the <fixedpre>&prefListChunkName</fixedpre> property to point to it. By default, the chunk used will be <fixedpre>sbsPrefListTpl</fixedpre>, which is the default chunk used for tags in the Subscribe extra. </p>

<p>The format for the Preferences List Tpl chunk is a series of <fixedpre>Caption==value</fixedpre> pairs separated by <fixedpre>||</fixedpre>:</p>

<p>Example:</p>

<pre><fixedpre>
Caption One==Option1||Caption Two==option2||Caption Three==option3
</fixedpre></pre>

<p>The &quot;caption&quot; (to the left of the <fixedpre>==</fixedpre> signs) is what is shown in the Subscribe extra Register and Manage Preferences forms. The &quot;value&quot; (to the right of the <fixedpre>==</fixedpre> signs) is what will be stored in the database and what will show in the Notify form. Make sure there are no spaces except in between the words of the caption and the preferences list is all on one line.</p>

<p>In the Notify form, clicking on a tag button will add or delete that tag from the &quot;Tags&quot; field of the form. The tag buttons shown are based on the tags in the chunk specified in the <fixedpre>sbsPrefListTpl</fixedpre> property.</p>

<h3>Notify and Articles</h3>

<p>To the best of my ability to test it, Notify works fine with Articles. You need to attach the Notify TV to whatever template you use for your Articles posts, otherwise it works as expected. Notify will use the URL shortener specified in the Notify properties rather than the one used by Articles. The only other thing to remember is that the tags used by Articles and Notify are independent. Notify will ignore the Articles tags and Articles will ignore the Notify tags. This is intentional because the Notify tags match up with the limited list of Subscriber interests and the Articles tags are to help users find Articles.</p>

<h3>Email Log</h3>

<p>For each email update, Notify writes a log file to the <fixedpre>core/components/notify/notify-logs</fixedpre> directory. The file is named for the resource and date and time of the update. The log shows the message sent, the users and their tags, and if possible any problems in sending the email to each user.</p>

<h3>Setting the Notify Properties</h3>

<p>Notify has many properties, but for most of them, the default values will work fine. You'll need to set the Twitter properties to send Tweets. Depending on the URL shortening service you use, you may also have to set the URL shortener properties if you want short URLs. If you want to change the Tpl chunks, you'll want to duplicate them and use a property set as described above to set the properties that tell Notify their names so your changes won't be overwritten when Notify is upgraded.</p>

<h3>Posting Updates to Twitter</h3>

<p>In order for Notify to post updates to Twitter, you'll need to create a Twitter App at the <a href="https://dev.twitter.com/apps/new">Twitter Dev site</a> (if you don't have one already). Follow the instructions at that URL for creating a new application. Once you have it all set up, you can go to the the URL above and select the &quot;My Applications&quot; breadcrumb at the top left. Then, click on your Twitter username and select the &quot;OAuth Tool&quot; tab. you should see the four keys you need to set the Notify properties.</p>
        
<p>See the section above on creating a property set if you haven't done so already. To set the properties, edit the Notify snippet and click on the &quot;Properties&quot; tab. Then select your property set by clicking on the word &quot;Default&quot; just above the grid on the right. Double-click on a value to change it, and when you're done, click on the &quot;Save Property Set&quot; button (*not* the &quot;Save&quot; button).</p>
        
<p>Once you've cleared the cache, you can post an update to Twitter from the Template Variable tab of the Create/Edit Resource panel in the Manager. Notify will pre-fill the Tweet TV for you, but you can edit it to contain whatever you like. Notify will enforce the 140-character limit on the length of the tweet. </p>

<h3>Posting Updates to Facebook</h3>
        
<p>Notify does not post directly to Facebook, but you can set
up an account at <a href = "http://apps.facebook.com/selectivetwitter/">Selective Twitter</a> in about 30 seconds. Once you've done that, simply add the hashtag <fixedpre>#fb</fixedpre> to any Tweet and the Tweet will be posted to your Facebook page in addition to Twitter. If you set the <fixedpre>&notifyFacebook</fixedpre> property of the Notify snippet, the <fixedpre>#fb</fixedpre> hashtag will be added automatically to the end of the Tweet and you'll see it in the Notify form. The Facebook App will remove that hashtag in the Tweet.</p>

<p>You can also use the <a href="http://apps.facebook.com/twitter/">Twitter App</a> if you want to post *all* your Tweets to Facebook, but I don't recommend doing that if you're a heavy Twitter user because it will load up your Facebook page with lots of Tweets that most visitors won't want to see.</p>


<a name="propertiesTable"></a>


<h3>Notify Properties</h3>

<table class="properties">
    <tr><th>Property</th><th>Description</th><th>Default</th></tr>

    <tr>
        <td>urlShorteningService</td>
        <td>Service used to shorten all URLs in text and Tweet</td>
        <td>none</td>
    </tr>
    <tr>
        <td>groups</td>
        <td>Comma-separated list of User Groups to send to (no spaces). The Subscribers group will be set in the form, but if you delete it and submit with the Groups field empty, email will be sent to all users on the site</td>
        <td>Subscribers</td>
    </tr>
    <tr>
        <td>tags</td>
        <td>(optional) Comma-separated list of tags (no spaces). If set, only users in specified Groups with the interest(s) set will receive the email</td>
        <td></td>
    </tr>
    <tr>
        <td>notifyFacebook</td>
        <td>Notify Facebook via Twitter with #fb in tweet -- must be set up in the Facebook Twitter App</td>
        <td></td>
    </tr>
    <tr>
        <td>twitterConsumerKey</td>
        <td>Twitter Consumer Key</td>
        <td></td>
    </tr>
    <tr>
        <td>twitterConsumerSecret</td>
        <td>Twitter Consumer Secret</td>
        <td></td>
    </tr>
    <tr>
        <td>twitterOauthToken</td>
        <td>Twitter Access Token</td>
        <td></td>
    </tr>
    <tr>
        <td>twitterOauthSecret</td>
        <td>Twitter Access Token Secret</td>
        <td></td>
    </tr>
    <tr>
        <td>bitlyApiKey</td>
        <td>bit.ly API key (required)</td>
        <td></td>
    </tr>
    <tr>
        <td>bitlyUsername</td>
        <td>bit.ly username (required)</td>
        <td></td>
    </tr>
    <tr>
        <td>googleApiKey</td>
        <td>Google API key</td>
        <td></td>
    </tr>
    <tr>
        <td>suprApiKey</td>
        <td>StumbleUpon API key (optional)</td>
        <td></td>
    </tr>
    <tr>
        <td>suprUsername</td>
        <td>Stumble Upon Username (optional)</td>
        <td></td>
    </tr>
    <tr>
        <td>tinyurlApiKey</td>
        <td>TinyUrl API key (optional)</td>
        <td></td>
    </tr>
    <tr>
        <td>tinyurlUsername</td>
        <td>TinyUrl username (optional)</td>
        <td></td>
    </tr>
    <tr>
        <td>mailFrom</td>
        <td>(optional) MAIL_FROM setting for email</td>
        <td>emailsender System Setting</td>
    </tr>
    <tr>
        <td>mailFromName</td>
        <td>(optional) MAIL_FROM_NAME setting for email</td>
        <td>site_name System Setting</td>
    </tr>
    <tr>
        <td>mailSender</td>
        <td>(optional) EMAIL_SENDER setting for email</td>
        <td>emailsender System Setting</td>
    </tr>
    <tr>
        <td>mailReplyTo</td>
        <td>(optional) REPLY_TO setting for email</td>
        <td>emailsender System Setting</td>
    </tr>
    <tr>
        <td>nfFormTpl</td>
        <td>Name of chunk to use for the Notify form</td>
        <td>NfNotifyFormTpl</td>
    </tr>
    <tr>
        <td>nfEmailTplNew</td>
        <td>Name of chunk to use for the new resource Notify email</td>
        <td>NfSubscriberEmailTplNew</td>
    </tr>
    <tr>
        <td>nfEmailTplExisting</td>
        <td>Name of chunk to use for updated resource Notify email</td>
        <td>NfSubscriberEmailTplExisting</td>
    </tr>
    <tr>
        <td>nfEmailTplCustom</td>
        <td>Name of chunk to use for custom Notify email Tpl</td>
        <td>NfSubscriberEmailTplCustom</td>
    </tr>
    <tr>
        <td>nfTweetTplNew</td>
        <td>Name of chunk to use for the new resource Tweet text</td>
        <td>nfTweetTplNew</td>
    </tr>
    <tr>
        <td>nfTweetTplExisting</td>
        <td>Name of chunk to use for the updated resource Tweet text</td>
        <td>nfTweetTplExisting</td>
    </tr>
    <tr>
        <td>nfTweetTplCustom</td>
        <td>Name of chunk to use for the custom Tweet text</td>
        <td>nfTweetTplCustom</td>
    </tr>
    <tr>
        <td>nfSubjectTpl</td>
        <td>Name of chunk to use for the Email subject</td>
        <td>NfEmailSubjectTpl</td>
    </tr>
    <tr>
        <td>nfTestEmailAddress</td>
        <td>(optional) Email address for test email</td>
        <td>emailsender System Setting</td>
    </tr>
    <tr>
        <td>sortBy</td>
        <td>(optional) Field to sort by when selecting users</td>
        <td>username</td>
    </tr>
    <tr>
        <td>userClass</td>
        <td>(optional) class of the user object. Only necessary if you have subclassed the user object</td>
        <td>modUser</td>
    </tr>
    <tr>
        <td>sortByAlias</td>
        <td>(optional) class of the user object. Only necessary if you have subclassed the user object</td>
        <td>modUser</td>
    </tr>
    <tr>
        <td>profileAlias</td>
        <td>(optional) class of the user profile object. Only necessary if you have subclassed the user profile object</td>
        <td>modUserProfile</td>
    </tr>
    <tr>
        <td>profileClass</td>
        <td>(optional) class of the user profile object. Only necessary if you have subclassed the user profile object</td>
        <td>modUserProfile</td>
    </tr>
    <tr>
        <td>batchSize</td>
        <td>(optional) Batch size for bulk email to subscribers</td>
        <td>50</td>
    </tr>
    <tr>
        <td>batchDelay</td>
        <td>(optional) Delay between batches in seconds</td>
        <td>1</td>
    </tr>
    <tr>
        <td>itemDelay</td>
        <td>(optional) Delay between individual emails in seconds</td>
        <td>.51</td>
    </tr>
    <tr>
        <td>prefListChunkName</td>
        <td>(optional) Chunk to use for preferences (tags) list</td>
        <td>sbsPrefListTpl</td>
        </tr>
</table>



